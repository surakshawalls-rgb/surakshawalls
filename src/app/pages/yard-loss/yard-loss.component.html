<!-- src/app/pages/yard-loss/yard-loss.component.html -->
<div class="yard-loss-container">
  <div class="header">
    <h2>Yard Loss / Wastage</h2>
    <p class="subtitle">Record damaged or lost products</p>
  </div>

  <div *ngIf="loading" class="loading">Loading...</div>
  <div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>
  <div *ngIf="errorMessage" class="alert alert-error">{{ errorMessage }}</div>

  <div class="content-grid" *ngIf="!loading">
    <!-- Form -->
    <div class="form-card">
      <h3>Record Yard Loss</h3>

      <div class="form-group">
        <label>Date <span class="required">*</span></label>
        <input type="date" [(ngModel)]="date" class="form-control">
      </div>

      <div class="form-group">
        <label>Product <span class="required">*</span></label>
        <select [(ngModel)]="productName" class="form-control">
          <option value="">Select Product</option>
          <option *ngFor="let product of products" [value]="product">{{ product }}</option>
        </select>
      </div>

      <div class="form-group">
        <label>Quantity <span class="required">*</span></label>
        <input type="number" [(ngModel)]="quantity" min="0" class="form-control">
      </div>

      <div class="form-group">
        <label>Stage <span class="required">*</span></label>
        <select [(ngModel)]="stage" class="form-control">
          <option value="stacking">Stacking</option>
          <option value="loading">Loading</option>
          <option value="transport">Transport</option>
        </select>
      </div>

      <div class="form-group">
        <label>Reason</label>
        <select [(ngModel)]="reason" class="form-control">
          <option value="">Select Reason</option>
          <option value="Breakage">Breakage</option>
          <option value="Crack">Crack</option>
          <option value="Mishandling">Mishandling</option>
          <option value="Poor Quality">Poor Quality</option>
          <option value="Other">Other</option>
        </select>
      </div>

      <div class="form-group">
        <label>Notes</label>
        <textarea [(ngModel)]="notes" rows="3" class="form-control"></textarea>
      </div>

      <div class="action-buttons">
        <button (click)="recordLoss()" [disabled]="saving" class="btn btn-primary">
          {{ saving ? 'Recording...' : 'Record Loss' }}
        </button>
        <button (click)="resetForm()" class="btn btn-secondary">Reset</button>
      </div>
    </div>

    <!-- History -->
    <div class="history-card">
      <h3>Recent Wastage</h3>
      <div class="history-list">
        <div *ngFor="let loss of wastageHistory" class="history-item">
          <div class="history-header">
            <strong>{{ loss.product_name }}</strong>
            <span class="quantity">{{ loss.quantity }} units</span>
          </div>
          <div class="history-details">
            {{ loss.date }} â€¢ {{ loss.stage }}
          </div>
          <div class="history-reason" *ngIf="loss.reason">{{ loss.reason }}</div>
        </div>
        <div *ngIf="wastageHistory.length === 0" class="no-data">No wastage records</div>
      </div>
    </div>
  </div>
</div>
