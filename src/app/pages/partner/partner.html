<div class="partner-container">

  <!-- Header with Tabs -->
  <div class="top-bar">
    <h2>ЁЯдЭ {{language==='EN'?'Partner Management':'рдкрд╛рд░реНрдЯрдирд░ рдкреНрд░рдмрдВрдзрди'}}</h2>
    <button class="lang-btn" (click)="toggleLang()">ЁЯМР {{language}}</button>
  </div>

  <!-- Tab Navigation -->
  <div class="tab-navigation">
    <button 
      [class.active]="activeTab === 'ledger'"
      (click)="activeTab = 'ledger'"
      class="tab-btn">
      ЁЯУЛ {{language==='EN'?'Ledger':'рд▓реЗрдЬрд░'}}
    </button>
    <button 
      [class.active]="activeTab === 'withdraw'"
      (click)="activeTab = 'withdraw'"
      class="tab-btn">
      ЁЯТ╕ {{language==='EN'?'Withdraw':'рдирд┐рдХрд╛рд╕реА'}}
    </button>
  </div>

  <!-- LEDGER TAB -->
  @if(activeTab === 'ledger') {
  <div class="tab-content">

  <!-- Date -->
  <label>{{language==='EN'?'Date':'рддрд╛рд░реАрдЦ'}}</label>
  <input type="date" [(ngModel)]="date">

  <!-- Add Expense -->
  <div class="card">
    <h3>{{language==='EN'?'Add Partner Expense':'рдкрд╛рд░реНрдЯрдирд░ рдЦрд░реНрдЪ рдЬреЛрдбрд╝реЗрдВ'}}</h3>

    <select [(ngModel)]="partnerId" (change)="onPartnerChange()">
      <option *ngFor="let p of partners" [value]="p.id">{{p.partner_name}}</option>
    </select>

    <select [(ngModel)]="category">
      <option>Sariya</option>
      <option>Cement</option>
      <option>Sand</option>
      <option>Gitti</option>
      <option>Diesel</option>
      <option>Snacks</option>
      <option>Mobile</option>
      <option>Maintenance</option>
      <option>Other</option>
    </select>

    @if(category==='Other'){
      <input placeholder="Description" [(ngModel)]="otherDescription">
    }

    <input placeholder="{{language==='EN'?'Reason':'рдХрд╛рд░рдг'}}" [(ngModel)]="title">
    <input type="number" placeholder="{{language==='EN'?'Amount':'рд░рд╛рд╢рд┐'}}" [(ngModel)]="amount">

    <button class="save-btn" (click)="saveExpense()">ЁЯТ╛ Save</button>
  </div>

  <!-- Profit -->
  <div class="card">
    <h3>ЁЯУК {{language==='EN'?'Profit Share':'рд▓рд╛рдн рд╡рд┐рддрд░рдг'}}</h3>
    <p>Pradeep: тВ╣{{profitPradeep}}</p>
    <p>Praveen: тВ╣{{profitPraveen}}</p>
    <p>Pappu: тВ╣{{profitPappu}}</p>
  </div>

  <!-- Table -->
  <div class="card">
    <h3>ЁЯУТ {{language==='EN'?'Partner Expenses':'рдкрд╛рд░реНрдЯрдирд░ рдЦрд░реНрдЪ рд╕реВрдЪреА'}}</h3>

    <div class="table-wrapper">
      <table class="partner-table">
        <tr>
          <th>Date</th>
          <th>Partner</th>
          <th>Category</th>
          <th>Title</th>
          <th>Amount</th>
        </tr>

        @for(r of records; track $index){
          <tr>
            <td>{{formatDateToDDMMYYYY(r.date)}}</td>
            <td>{{r.partner_id}}</td>
            <td>-</td>
            <td>{{r.description}}</td>
            <td>тВ╣{{r.amount}}</td>
          </tr>
        }
      </table>
    </div>

    <!-- Pagination -->
    <div class="pagination">
      <button (click)="prevPage()">тмЕ Prev</button>
      <span>Page {{page+1}}</span>
      <button (click)="nextPage()">Next тЮб</button>
      <button class="refresh-btn" (click)="refreshTable()">ЁЯФД Refresh</button>
    </div>

  </div>

  </div>
  }

  <!-- WITHDRAW TAB -->
  @if(activeTab === 'withdraw') {
  <div class="tab-content">
    <app-partner-withdraw></app-partner-withdraw>
  </div>
  }

</div>

<!-- Loader -->
<div *ngIf="loading" class="loader-overlay">
  <div class="loader-box">тП│ Loading...</div>
</div>
